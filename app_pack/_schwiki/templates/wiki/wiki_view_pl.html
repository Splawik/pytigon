{# -*- coding: utf-8 -*- #}
{% extends "form.html" %}
{% load exfiltry %}
{% load exsyntax %}
{% block all %}
        {% with form_info=False show_form=False form_width=470 form_height=665 %}
                {{ block.super }}
        {% endwith %}
{% endblock %}
{% block jquery_ovr2 %}
        var options = {
            success: RefreshWin2
        }
        function RefreshWin2(responseText, statusText) {
            location.href = "/schwiki/{{subject}}/{{page_name}}/view/"
        }
{% endblock %}
{% block extrastyle %}
        {% if standard_web_browser %}
                {% css_link 'pygments/pygments_style.css' %}
        {% endif %}
{% endblock %}
{% block pythoncode %}
        <script language="python">
        def init_form(self):
            self.GetParent().register_signal(self, "refresh_controls")
        def refresh_controls(self):
            print("refresh_controls")
            self.GetParent().refresh_html()
            print("refresh_controls_2")
</script>
        {% if standard_web_browser %}
                <link rel="Stylesheet" type="text/css" href="^auto/schwiki/css/wiki.css"></link>
        {% endif %}
{% endblock %}
{% block table_title %}{% endblock %}
{% block scroll %}{% endblock %}
{% block _nav %}{% endblock %}
{% block form_rect %}
        width: 600, height: 890
{% endblock %}
{% block form_bar %}
        {% if not standard_web_browser %}
                {% if perms.schwiki.add_page %}
                        <table width="100%" class="form_bar">
                                <tr>
                                        {% if False %}
                                                <td cellpadding="0" align="right" valign="top" width="36" height="36">
                                                        <CTRLCLOSEBUTTON width="36" height="36" NAME="EXIT" SRC="client://emblems/emblem-unreadable.png"></CTRLCLOSEBUTTON>
                                                </td>
                                        {% endif %}
                                        {% if content %}
                                                <td cellpadding="0" align="right" valign="top" width="36" height="36">
                                                        <CTRLNOBG_BUTTON width="36" height="36" href="/wiki/{{subject}}/{{page_name}}/edit/" label="edytuj stronę" SRC="client://apps/accessories-text-editor.png"></CTRLNOBG_BUTTON>
                                                </td>
                                          {% else %}
                                                <td cellpadding="0" align="right" valign="top" width="110" height="36">
                                                        <CTRLNOBG_BUTTON width="36" height="36" href="/wiki/{{subject}}/{{page_name}}/edit/" label="edytuj stronę jako wiki" SRC="client://apps/accessories-character-map.png"></CTRLNOBG_BUTTON>
                                                        <CTRLNOBG_BUTTON width="36" height="36" href="/wiki/{{subject}}/{{page_name}}/edit/" label="edytuj stronę jako ihtml" SRC="client://actions/format-indent-more.png"></CTRLNOBG_BUTTON>
                                                        <CTRLNOBG_BUTTON width="36" height="36" href="/wiki/{{subject}}/{{page_name}}/edit/" label="edytuj stronę jako html" SRC="client://apps/accessories-text-editor.png"></CTRLNOBG_BUTTON>
                                                </td>
                                        {% endif %}
                                        <td width="5"></td>
                                        <td align="center" border="0" border-color="#{{color_body_0_7}}">
                                                <span class="form_title">
                                                        {% block form_title %}
                                                                {{title|wiki_href|safe}}
                                                        {% endblock %}
                                                </span>
                                        </td>
                                </tr>
                        </table>
                {% endif %}
        {% endif %}
{% endblock %}
{% block list_content_header %}
        {% if standard_web_browser and perms.schwiki.add_page %}
                <a data-toggle="collapse" href="#collapse" style="position: absolute;right: 5px;">
                        <span class="fa-arrows-v fa fa-fw"></span>
                </a>
                <div id="collapse" class="panel-collapse collapse">
                        {{ block.super }}
                </div>
        {% endif %}
{% endblock %}
{% block list_content_title %}
        <h4 style="white-space:nowrap;">{{subject}}: {{page_name}}</h4>
{% endblock %}
{% block list_content_actions %}
        {% if content %}
                {% button "/schwiki/"|append_str:subject|append_str:"/"|append_str:page_name|append_str:"/edit/" "edytuj stronę" %}
          {% else %}
                {% button "/schwiki/"|append_str:subject|append_str:"/"|append_str:page_name|append_str:"/edit/" "edytuj stronę wiki" %}
                {% button "/schwiki/"|append_str:subject|append_str:"/"|append_str:page_name|append_str:"/edit/" "edytuj stronę ihtml" %}
                {% button "/schwiki/"|append_str:subject|append_str:"/"|append_str:page_name|append_str:"/edit/" "edytuj stronę html" %}
        {% endif %}
{% endblock %}
{% block form %}
        {% if perms.schwiki.add_page %}
                {{ block.super }}
          {% else %}
                {{content|wikify|safe}}
        {% endif %}
{% endblock %}
{% block list_content_body %}
        {% if wiki_path_list %}
                {% if standard_web_browser %}
                        <ol class="breadcrumb">
                                {% for wiki_elem in wiki_path_list %}
                                        <li>
                                                {{ '[['|append_str:wiki_elem|append_str:']]'|wikify:wiki_path|safe }}
                                        </li>
                                {% endfor %}
                        </ol>
                  {% else %}
                        <table width="100%">
                                <tr bgcolor="#{{color_background_0_9}}">
                                        <td></td>
                                </tr>
                                <tr>
                                        <td bgcolor="#{{color_background_0_9}}">
                                                {% for wiki_elem in wiki_path_list %}
                                                        {{ '[['|append_str:wiki_elem|append_str:']]'|wikify:wiki_path|safe }}/
                                                {% endfor %}
                                                >
                                        </td>
                                </tr>
                                <tr><td></td></tr>
                        </table>
                        <br />
                {% endif %}
        {% endif %}
        <div class="panel-body">
                {% if content %}
                        {% if wiki_path %}
                                {{content|wikify:wiki_path|safe}}
                          {% else %}
                                {{content|wikify|safe}}
                        {% endif %}
                  {% else %}
                        Ta strona jeszcze nie istnieje!
                {% endif %}
        </div>
{% endblock %}

