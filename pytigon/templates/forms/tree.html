{# -*- coding: utf-8 -*- #}
{% extends "form.html" %}
{% load exfiltry %}
{% load exsyntax %}
{% block list_content_title %}
        {% if parent_pk > 0 %}
                <h4 style="white-space:nowrap;" class="txt3d wiki-title">
                        {{title|wiki_href|safe}}
                        {% if parent_obj %}
                                <span>
                                        {% if parent_obj.title %}
                                                - {{parent_obj.title}}
                                          {% else %}
                                                - {{parent_obj}}
                                        {% endif %}
                                </span>
                        {% endif %}
                </h4>
          {% else %}
                <h4 style="white-space:nowrap;" class="txt3d wiki-title">{{title|wiki_href|safe}}</h4>
        {% endif %}
{% endblock %}
{% block list_content_actions %}
        {% with gtree=get|get_or_tree %}
                {% if standard_web_browser %}
                        <span class="tree-home">
                                {% if parent_pk > 0 and base_filter != parent_pk|tostr %}
                                        {% if base_filter %}
                                                {% action "home-refresh_frame" "/" url=table_path_and_base_filter|append_str:base_filter|append_str:'/form/{{gtree}}/' %}
                                          {% else %}
                                                {% action "home-refresh_frame" "/" url=table_path_and_base_filter|append_str:'0/form/{{gtree}}/' %}
                                        {% endif %}
                                  {% else %}
                                        {% action "home-refresh_frame" "/" url=table_path_and_base_filter|append_str:'0/form/tree/' tag_class="+disabled" %}
                                {% endif %}
                        </span>
                  {% else %}
                        {% if parent_pk > 0 and base_filter != parent_pk|tostr %}
                                <CTRL-BUTTON name="back" href="{{table_path_and_base_filter}}-{{parent_pk}}/form/{{ro}}{{gtree}}/" target="refresh_frame" src="wx.ART_GO_BACK" label="Back"></CTRL-BUTTON>
                          {% else %}
                                <CTRL-BUTTON name="back" href="_disable" target="_self" src="wx.ART_GO_BACK" label="Back"></CTRL-BUTTON>
                        {% endif %}
                        <a href="{{table_path_and_base_filter}}0/form/{{gtree}}/" class="button btn btn-secondary">/</a>
                {% endif %}
                <span class="tree-toolbar">
                        {% for pos in parent_obj|getallparents reversed %}
                                {% if not forloop.last %}
                                        {% action "back-refresh_frame" pos.code url=table_path_and_base_filter|append_str:'{{pos.id}}/form/{{gtree}}/' %}
                                {% endif %}
                        {% endfor %}
                </span>
                {% block list_content_actions_new_row %}
                        {% if not readonly %}
                                {% if parent_pk > 0 %}
                                        {% new_row "New element" url=table_path|append_str:'%d/this/-/add/'|format:parent_obj.id %}
                                  {% else %}
                                        {% new_row "New element" url=table_path|append_str:'0/this/-/add/' %}
                                {% endif %}
                        {% endif %}
                {% endblock %}
        {% endwith %}
{% endblock %}
{% block list_row_header_start %}
        {% if not no_id %}
                <th data-field="cid" data-sortable="true" class="tree-id">
                        {% if standard_web_browser %}
                                {% with gtree=get|get_or_tree %}
                                        {% if parent_pk > 0 and base_filter != parent_pk|tostr %}
                                                {% action "back-refresh_frame" ".." url=table_path_and_base_filter|append_str:'-{{parent_pk}}/form/{{ro}}{{gtree}}/' %}
                                          {% else %}
                                                {% action "back-refresh_frame" ".." url=table_path_and_base_filter|append_str:'-{{parent_pk}}/form/{{ro}}{{gtree}}/' tag_class="+disabled" attrs="+disabled='disabled'" %}
                                        {% endif %}
                                {% endwith %}
                                {% id_num 'Id' %}
                        {% endif %}
                </th>
        {% endif %}
{% endblock %}
{% block id_extra %}
        {% with gtree=get|get_or_tree %}
                {% if object|children %}
                        <a href="{{table_path_and_base_filter}}{{object.id}}/form/{{ro}}{{gtree}}/" target="refresh_frame" class="button btn btn-outline-primary" name="+">
                                <span class="fa fa-lg fa-plus"></span>
                        </a>
                  {% else %}
                        {% if get %}
                                <span class="button btn">
                                        <span class="fa fa-lg fa-ban"></span>
                                </span>
                          {% else %}
                                <a href="{{table_path_and_base_filter}}{{object.id}}/form/{{ro}}{{gtree}}/" target="refresh_frame" class="button btn" name="+">
                                        <span class="fa fa-lg fa-plus-square-o"></span>
                                </a>
                        {% endif %}
                {% endif %}
                {{ block.super }}
        {% endwith %}
{% endblock %}
{% block tabsort_class %}
        {% if table_type == 'datatable' %}
                class="tabsort table datatable table-hover table-striped table-condensed {%if get %}table_get{% endif %}"
                data-url="{{table_path_and_filter}}json/{% if get %}{{get}}/{% else %}tree/{% endif %}"
                data-side-pagination="server"
                data-pagination="true"
                data-page-size="64"
                data-page-list="[64]"
                data-search="true"
                data-sortable="true"
                data-toolbar="#{{uuid}}_toolbar"
                data-locale="pl-PL"
                data-show-columns="true"
                data-icons-prefix="fa"
                data-id-field="cid"
                data-icons="icons"
          {% else %}
                class="tabsort table table-hover table-striped {%if get %}table_get{% endif %}"
        {% endif %}
{% endblock %}

